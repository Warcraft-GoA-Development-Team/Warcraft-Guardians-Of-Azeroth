######################Cipher Event - Harpy Events#############################
namespace = wcHO

#Mating event post sieging
character_event = {
	id = wcHO.1
	title = EVTTITLE_wcHO.1
	desc = EVTDESC_wcHO.1
	picture = GFX_evt_harpy_siege
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	hide_from = yes
	
	trigger = {
		ROOT = { 
			trait = creature_harpy
			culture = harpy
		}
		FROM = { 
			owner = {
				any_courtier = {
					is_female = no 
					at_location = FROM
					is_ruler = no
					is_adult = yes
				}
			}
		}
	}
	
	immediate = {
		FROM = { 
			owner = {
				random_courtier = {
					limit = { 			
						is_female = no 
						at_location = FROM
						is_ruler = no
						is_adult = yes
					}
					save_event_target_as = RHarpy
				}
			}
		}	
	}
	
	#Use them to Mate
	option = {
		trigger = {
			NOT = { 
				trait = infertile
			}
			is_adult = yes
		}
		name = EVTOPTA_wcHO.1
		prestige = 25
		piety = 50
		event_target:RHarpy = { 
				impregnate = ROOT
				death = { death_reason = harpy_death }
		}
	}
	
		
	#Share them with Dynasty
	option = {
		name = EVTOPTD_wcHO.1
		trigger = {
			any_dynasty_member = {
				NOT = { trait = infertile }
				is_female = yes
				trait = creature_harpy
				is_pregnant = no
				is_adult = yes
			}
		}
		random_dynasty_member = {
				limit = {
					NOT = { trait = infertile }
					is_female = yes
					trait = creature_harpy
					is_pregnant = no
					is_adult = yes
				}
				reverse_opinion = { modifier = opinion_happy who = ROOT years = 5 }
				prestige = 10
				save_event_target_as = chosen_f_harpy
		}
		event_target:RHarpy = { 
				impregnate = event_target:chosen_f_harpy
				death = { death_reason = harpy_death }
		}
	}
	
	
	
	#Use them as Concubines
	option = {
		trigger = {
			OR = {
				AND = {
					NOT = { 
						trait = infertile
					}
					is_adult = yes
				}
				any_courtier_or_vassal = {
					trait = creature_harpy
					is_adult = no
					NOT = { has_character_modifier = has_food_prepared }
				}
				ROOT ={
					trait = creature_harpy
					is_adult = no
					NOT = { has_character_modifier = has_food_prepared }
				}
			}
			NOT = { num_of_prisoners = 5 }
		}
		name = EVTOPTB_wcHO.1
		event_target:RHarpy = { 
			imprison = ROOT
		}
		prestige = -10		
	}
	
	
	#ShareThemWithTribe
	option = {
		trigger = {
			OR = {
				any_courtier = {
					is_female = yes
					trait = creature_harpy
					is_pregnant = no
					is_adult = yes
				}
				any_vassal = {
					is_female = yes
					trait = creature_harpy
					is_pregnant = no
					is_adult = yes
				}
			}
		}
		name = EVTOPTC_wcHO.1
		prestige = 40
		piety = 10
		#hidden_tooltip = {
			random_list = {
				50 = {
					random_courtier = {
						limit = {
							NOT = { trait = infertile }
							is_female = yes
							trait = creature_harpy
							is_pregnant = no
							is_adult = yes
						}
					prestige = 10
					reverse_opinion = { modifier = opinion_happy who = ROOT years = 5 }	
					save_event_target_as = chosen_harpy
					}
				}
				50 = {
					random_vassal = {
						limit = {
							NOT = { trait = infertile }
							is_female = yes
							trait = creature_harpy
							is_pregnant = no
							is_adult = yes
							ai = yes
						}
					prestige = 10
					reverse_opinion = { modifier = opinion_happy who = ROOT years = 5 }	
					save_event_target_as = chosen_harpy
					}
				}		
			}
		#}
		event_target:RHarpy = {
				impregnate = event_target:chosen_harpy
				death = { death_reason = harpy_death }
		}	
	}
}

#In case commander is not liege, it happens sometimes#
character_event = {
	id = wcHO.2
	picture = GFX_evt_harpy_siege
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	hide_from = yes
	hide_window = yes
	
	trigger = {
		ROOT = { 
			ai = yes
			is_landed = no
		}
	}
	
	
	immediate = {
		ROOT = {
			liege = {
				character_event = { id = wcHO.1 }
			}
		}
	}
	
	option = {
		name = EVTOPTA_wcHO.2
	}
}

#Feeding the baby once it reaches of age!
character_event = {
	id = wcHO.3
	title = EVTTITLE_wcHO.3
	desc = EVTDESC_wcHO.3
	picture = GFX_evt_harpy_siege
	border = GFX_event_normal_frame_diplomacy
	
	is_triggered_only = yes
	hide_from = yes
	
	trigger = {
		has_character_modifier = has_food_prepared
	}
	
	
	#Use them to Mate
	option = {
		name = EVTOPTA_wcHO.3
		remove_character_modifier = has_food_prepared
		custom_tooltip = { text = stat_increase_growup }
		random_list = { 
			40 = { change_diplomacy = 1 } 
			40 = { change_stewardship = 1 }
			40 = { change_martial = 1 }
			40 = { change_intrigue = 1 }
			40 = { change_learning = 1 }	
			20 = { change_diplomacy = 2 } 
			20 = { change_stewardship = 2 }
			20 = { change_martial = 2 }
			20 = { change_intrigue = 2 }
			20 = { change_learning = 2 }		
		}
	}
}

#Correction of traits considering harpy can basicaly mate with anyone and doesnt take in account race.
#Its eighter this solution or not knowing the father and i think this one is cleaner.
character_event = {
	id = wcHO.4
	
	is_triggered_only = yes
	hide_from = yes
	hide_window = yes
	
	trigger = {
		mother = {
			trait = creature_harpy
			}
	}
	
	immediate = {
		dynasty = mother
		add_trait = creature_harpy
		set_graphical_culture = harpy
		set_gender = female
		remove_trait = bastard
		remove_trait = legit_bastard
		remove_trait = creature_human
		remove_trait = creature_orc
		remove_trait = creature_ogre
		remove_trait = creature_troll
		remove_trait = creature_murloc
		remove_trait = creature_gnoll
		remove_trait = creature_kobold
		remove_trait = creature_dwarf
		remove_trait = creature_gnome
		remove_trait = creature_high_elf
		remove_trait = creature_blood_elf
		remove_trait = creature_naga
		remove_trait = creature_red_whelp
		remove_trait = creature_red_drake
		remove_trait = creature_red_dragon
		remove_trait = creature_red_wyrm
		remove_trait = creature_blue_whelp
		remove_trait = creature_blue_drake
		remove_trait = creature_blue_dragon
		remove_trait = creature_blue_wyrm
		remove_trait = creature_green_whelp
		remove_trait = creature_green_drake
		remove_trait = creature_green_dragon
		remove_trait = creature_green_wyrm
		remove_trait = creature_black_whelp
		remove_trait = creature_black_drake
		remove_trait = creature_black_dragon
		remove_trait = creature_black_wyrm
		remove_trait = creature_goblin
		remove_trait = creature_pygmy
		remove_trait = creature_hozen
		remove_trait = creature_draenei
		remove_trait = creature_arakkoa_corrupted
		remove_trait = creature_ghoul
		remove_trait = creature_wraith
		remove_trait = creature_banshee
		remove_trait = creature_plague_eruptor
		remove_trait = creature_abomination
		remove_trait = creature_lich
		remove_trait = creature_annihilan
		remove_trait = creature_nathrezim
		remove_trait = creature_eredruin
		remove_trait = creature_fel_orc
		remove_trait = creature_felblood_elf
		remove_trait = creature_satyr
		remove_trait = creature_eredar
		remove_trait = creature_sayaadi
		remove_trait = creature_shivarra
		remove_trait = creature_moarg
		remove_trait = creature_observer
		remove_trait = creature_avatar_of_sargeras
		remove_trait = creature_air_elemental
		remove_trait = creature_earth_elemental
		remove_trait = creature_fire_elemental
		remove_trait = creature_flamewaker
		remove_trait = creature_water_elemental
		remove_trait = creature_iron_dwarf
		remove_trait = creature_vrykul
		remove_trait = creature_tuskarr
		remove_trait = creature_magnataur
		remove_trait = creature_furbolg
		remove_trait = creature_gorloc
		remove_trait = creature_watcher
		remove_trait = creature_wolvar
		remove_trait = creature_taunka
		remove_trait = creature_kvaldir
		remove_trait = creature_nerubian
		remove_trait = creature_mechagnome
		remove_trait = creature_earthen
		remove_trait = creature_bronze_whelp
		remove_trait = creature_bronze_drake
		remove_trait = creature_bronze_dragon
		remove_trait = creature_bronze_wyrm
		remove_trait = creature_ice_giant
		remove_trait = creature_nraqi
		remove_trait = creature_cthraxxi
		remove_trait = creature_night_elf
		remove_trait = creature_tauren
		remove_trait = creature_centaur
		remove_trait = creature_quilboar
		remove_trait = creature_tolvir
		remove_trait = creature_qiraji
		remove_trait = creature_dryad
		remove_trait = creature_frostnymph
		remove_trait = creature_highborne
		remove_trait = creature_infinite_whelp
		remove_trait = creature_infinite_drake
		remove_trait = creature_infinite_dragon
		remove_trait = creature_infinite_wyrm
		remove_trait = creature_old_god
		remove_trait = creature_vulpera
		remove_trait = creature_sethrak
		remove_trait = creature_titan_keeper
		remove_trait = creature_titan
		remove_trait = creature_protector
		remove_trait = creature_ancient_war
		remove_trait = creature_ancient_lore
		remove_trait = creature_ancient_wind
	}

	option = {
	}
}